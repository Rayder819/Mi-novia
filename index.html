<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nuestra Historia ‚ù§Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hidden { display: none !important; } 
        .fade-in { animation: fadeIn 1s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        canvas { 
            border-radius: 24px; 
            touch-action: none; 
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
            background: #1a1a1a; 
            transition: background 5s ease;
        }
        .allow-scroll { overflow-y: auto !important; overflow-x: hidden; }
        .btn-adventure { transition: all 0.2s; border: 2px solid #fecdd3; }
        .btn-adventure:active { transform: scale(0.95); background-color: #fff1f2; }
        
        /* Contenedor del Coraz√≥n */
        .heart-container { position: relative; width: 100px; height: 90px; margin: 0 auto; }
        
        /* Partes del Coraz√≥n */
        .heart-part { 
            position: absolute; 
            width: 50px; 
            height: 80px; 
            background: #e11d48; 
            border-radius: 50px 50px 0 0; 
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .heart-left { transform: rotate(-45deg); left: 10px; transform-origin: 100% 100%; }
        .heart-right { transform: rotate(45deg); right: 10px; transform-origin: 0% 100%; }

        /* Estado Desbloqueado */
        .unlocked .heart-left { transform: rotate(-110deg) translateX(-40px); opacity: 0; }
        .unlocked .heart-right { transform: rotate(110deg) translateX(40px); opacity: 0; }
        .unlocked #lock-icon { transform: scale(0); opacity: 0; transition: all 0.5s; }

        .puzzle-piece {
        width: 100%;
        height: 100%;
        background-size: 300px 300px; /* Tama√±o total de nosotros.JPG */
        cursor: pointer;
        border-radius: 4px;
        transition: transform 0.2s, border 0.2s;
        border: 1px solid rgba(255,255,255,0.3);
        }
        .puzzle-piece.selected {
            transform: scale(0.95);
            border: 3px solid #e11d48;
            z-index: 10;
        }
    </style>
</head>
<body id="main-body" class="bg-rose-50 text-slate-800 font-sans min-h-screen flex flex-col items-center justify-center p-4 overflow-hidden">
    
    <audio id="musica-fondo" loop>
        <source src="golden-hour.mp3" type="audio/mpeg">
    </audio>

    <div id="start-screen" class="text-center fade-in max-w-sm">
        <div class="text-6xl mb-6">üíå</div>
        <h1 class="text-4xl font-extrabold text-rose-600 mb-4">¬°Hola Amor!</h1>
        <p class="mb-8 text-lg text-rose-400 font-medium">He preparado un viaje por nuestra historia. ¬øLista para empezar?</p>
        <button onclick="nextLevel('start-screen', 'quiz-screen')" class="bg-rose-500 text-white px-10 py-4 rounded-full text-xl font-bold shadow-xl active:scale-95 transition-all">
            ¬°Empezar!
        </button>
    </div>

    <div id="quiz-screen" class="hidden w-full max-w-md bg-white p-8 rounded-3xl shadow-2xl fade-in">
        <div class="flex justify-between items-center mb-6">
            <span class="text-rose-300 font-bold uppercase tracking-widest text-xs">Misi√≥n 1: Reflexi√≥n</span>
            <span id="progress" class="text-rose-500 font-bold">1/8</span>
        </div>
        <h2 class="text-2xl font-bold mb-4 text-slate-700" id="quiz-question">Cargando...</h2>
        <textarea id="user-input" rows="3" class="w-full p-4 border-2 border-rose-100 rounded-2xl focus:border-rose-400 focus:outline-none transition-colors resize-none mb-6" placeholder="Responde de coraz√≥n..."></textarea>
        <button onclick="handleQuizNext()" class="w-full bg-rose-500 text-white py-4 rounded-2xl font-bold text-lg shadow-lg active:scale-95 transition-all">Siguiente</button>
    </div>

    <div id="adventure-screen" class="hidden w-full max-w-md bg-white p-8 rounded-3xl shadow-2xl fade-in text-center">
        <span class="text-rose-300 font-bold uppercase tracking-widest text-xs mb-4 block">Misi√≥n 2: Nuestra Aventura</span>
        <div id="adventure-content">
            <h2 id="adventure-question" class="text-2xl font-bold mb-6 text-slate-700"></h2>
            <div id="adventure-options" class="flex flex-col gap-4"></div>
        </div>
    </div>

    <div id="game-screen" class="hidden text-center fade-in w-full max-w-4xl">
        <h2 class="text-2xl font-bold mb-2 text-rose-500">Misi√≥n 3: Nuestra Trayectoria</h2>
        <p class="mb-4 text-slate-500 italic text-sm">Mant√©n presionado para elevar nuestro amor y recolectar los recuerdos</p>
        <div class="relative inline-block w-full">
            <canvas id="gameCanvas" width="800" height="400" class="w-full h-auto"></canvas>
            <div id="story-overlay" class="absolute inset-0 flex items-center justify-center pointer-events-none opacity-0 transition-opacity duration-1000">
                <div class="bg-white/90 p-6 rounded-2xl shadow-xl text-xl font-bold text-rose-600 border-2 border-rose-200" id="story-text"></div>
            </div>
        </div>
    </div>

    <div id="lock-screen" class="hidden w-full max-w-md bg-white p-8 rounded-3xl shadow-2xl fade-in text-center">
        <span class="text-rose-300 font-bold uppercase tracking-widest text-xs mb-4 block">Misi√≥n 4: Desbloquea mi Coraz√≥n</span>
        <div id="lock-visual" class="heart-container mb-8">
            <div class="heart-part heart-left"></div>
            <div class="heart-part heart-right"></div>
            <div class="absolute inset-0 flex items-center justify-center"><span id="lock-icon" class="text-3xl">üîí</span></div>
        </div>
        <h2 id="lock-question" class="text-xl font-bold mb-6 text-slate-700 italic"></h2>
        <div id="lock-options" class="grid grid-cols-1 gap-3"></div>
        <p id="lock-progress" class="mt-6 text-sm text-rose-300 font-bold"></p>
    </div>

    <div id="puzzle-screen" class="hidden w-full max-w-md bg-white p-6 rounded-3xl shadow-2xl fade-in text-center">
    <span class="text-rose-300 font-bold uppercase tracking-widest text-xs mb-4 block">Misi√≥n 5: Encajamos Perfecto</span>
    <p class="mb-4 text-slate-500 text-sm italic">Ordena nuestra foto para desbloquear la carta</p>
    
    <div id="puzzle-board" class="grid grid-cols-3 gap-1 mx-auto bg-rose-100 p-1 rounded-xl shadow-inner" style="width: 300px; height: 300px;">
        </div>
    
    <div id="puzzle-message" class="mt-4 text-rose-600 font-bold opacity-0 transition-opacity duration-1000">
        ‚ÄúAs√≠ como este puzzle‚Ä¶ encajamos perfecto.‚Äù
        </div>
    </div>

    <div id="final-screen" class="hidden fixed inset-0 bg-slate-900 z-50 flex flex-col items-center justify-center p-6 text-center overflow-y-auto">
    <div class="max-w-2xl w-full space-y-12">
        <div id="epic-sequence" class="space-y-12">
            <div class="step hidden fade-in"><img src="img1.JPG" class="rounded-2xl mx-auto shadow-2xl border-4 border-rose-500/30 max-h-64"><p class="text-2xl text-rose-100 mt-4 italic">‚ÄúSomos amorosos‚Ä¶‚Äù</p></div>
            <div class="step hidden fade-in"><img src="img2.JPG" class="rounded-2xl mx-auto shadow-2xl border-4 border-rose-500/30 max-h-64"><p class="text-2xl text-rose-100 mt-4 italic">‚ÄúSomos intensos‚Ä¶‚Äù</p></div>
            <div class="step hidden fade-in"><img src="img3.JPG" class="rounded-2xl mx-auto shadow-2xl border-4 border-rose-500/30 max-h-64"><p class="text-2xl text-rose-100 mt-4 italic">‚ÄúSomos un poquito cursis‚Ä¶‚Äù</p></div>
            <div class="step hidden fade-in"><img src="img4.JPG" class="rounded-2xl mx-auto shadow-2xl border-4 border-rose-500/30 max-h-64"><p class="text-2xl text-rose-100 mt-4 italic">‚ÄúY me encanta que seamos de todo‚Ä¶‚Äù</p></div>
            
            <div class="step hidden fade-in pb-12">
                <img src="nosotros.JPG" class="rounded-2xl mx-auto shadow-2xl border-8 border-rose-600 max-h-80 mb-6">
                <h2 class="text-3xl font-bold text-rose-400">Pero sobre todo‚Ä¶</h2>
                <h1 class="text-5xl font-black text-white mt-2 mb-8">SOMOS NOSOTROS ‚ù§Ô∏è</h1>
                
                <div id="love-letter" class="text-lg text-slate-300 leading-relaxed text-left bg-slate-800/50 p-8 rounded-2xl border-l-8 border-rose-600 whitespace-pre-wrap"></div>
                
                <div class="mt-12 pt-8 border-t border-slate-700">
                    <button id="secret-btn" onclick="revelarSecreto()" class="text-rose-400 text-xs italic">P.D: No presionar üò≥</button>
                    <div id="secret-message" class="hidden text-rose-300 mt-4 font-bold animate-bounce">‚ÄúSab√≠a que lo presionar√≠as, coqueta‚Ä¶ üòâ
                        Feliz 14 de Febrero amor de mi vida üíòüí¶üí¶‚Äù</div>
                </div>
            </div>
        </div>
    </div>
</div>

    
    <script>
        const FORMSPREE_ID = "meelalrz"; 
        
        const questions = [
            "¬øCu√°l crees que fue el momento exacto en que supiste que val√≠a la pena luchar por nosotros?",
            "¬øQu√© sentiste ese d√≠a en q nos dimos que somos muy compatibles a pesar de ser tan diferentes?",
            "¬øC√≥mo cambi√≥ tu vida el d√≠a que rescatamos a esos 7 cachorritos?",
            "Si pudieras decirnos algo a nosotros mismos cuando reci√©n empez√°bamos y era dif√≠cil, ¬øqu√© ser√≠a?",
            "¬øQu√© es lo que m√°s valoras de nuestra relaci√≥n despu√©s de todo lo que hemos pasado?",
            "¬øHay alg√∫n momento o recuerdo que siempre te haga sonre√≠r cuando lo piensas? ¬øCu√°l es y por qu√©?",
            "¬øQu√© sentiste ese d√≠a en el concierto de Kidd Voodoo cuando te ped√≠ matrimonio?",
            "Bueno no te molesto con mas preguntas, pero si quieres decirme algo m√°s, algo que no te haya preguntado pero que quieras compartir conmigo, este es el momento perfecto para hacerlo ‚ù§Ô∏è"
        ];

        const adventureData = {
            inicio: {
                q: "Cuando te vi por primera vez... ¬øqu√© crees que hice?",
                options: [
                    { t: "Me hice el interesante üòé", next: "interesante" },
                    { t: "Me puse caliente üí¶", next: "caliente" },
                    { t: "Te habl√© directo üí¨", next: "directo" },
                    { t: "Me qued√© callado y te mir√© fijamente üëÄ", next: "interesante" }
                ]
            },
            interesante: {
                q: "Trate de ser misterioso, pero no me salio DHDFJKA ¬øQu√© pensaste t√∫?",
                options: [
                    { t: "Que era un pesado üòÇ", next: "final_aventura" },
                    { t: "Que te llam√© la atenci√≥n ‚ú®", next: "final_aventura" },
                    { t: "Que era un poco raro pero me gust√≥ üòÖ", next: "final_aventura" },
                    { t: "Que me estabas mirando raro üëÄ", next: "final_aventura" }
                ]
            },
            caliente: {
                q: "Se m paro a penas te vi... Si hubieras sabido esto ¬øQue habrias hecho? üò≥",
                options: [
                    { t: "Me habr√≠a abrazado contigo üíû", next: "final_aventura" },
                    { t: "Me habr√≠a besado contigo üòò", next: "final_aventura" },
                    { t: "Te hubiera follado al frente del paulo", next: "final_aventura" },
                    { t: "Me meo", next: "final_aventura" }
                ]
            },
            directo: {
                q: "Fui directo al grano, no quer√≠a perder tiempo! ¬øTe asust√©?",
                options: [
                    { t: "Un poquito, pero me gust√≥ üò≥", next: "final_aventura" },
                    { t: "No, me pareci√≥ valiente üí™", next: "final_aventura" },
                    { t: "Me sorprendiste pero me gust√≥ üòÆ‚Äçüí®", next: "final_aventura" },
                    { t: "Me dejaste sin palabras üò∂", next: "final_aventura" }
                ]
            },
            final_aventura: {
                q: "Y sin importar el camino que tomamos ese d√≠a o las decisiones que tomemos hoy...",
                options: [
                    { t: "SIEMPRE TE ELIJO A TI ‚ù§Ô∏è", next: "FIN" }
                ]
            }
        };

        const lockQuestions = [
            { q: "¬øD√≥nde fue nuestra primera cita?", a: ["Mall", "En el Cine", "Tu casa", "Un parque", "Motel"], correct: 0 },
            { q: "¬øCu√°l fue el primer regalo que te hice?", a: ["Flores", "Plata", "Una carta", "Una Rosa"], correct: 3 },
            { q: "¬øCu√°l fue nuestra primera canci√≥n?", a: ["Destello", "Vea Pues", "La verdad", "Fluir", "Perd√°monos"], correct: 1 },
            { q: "¬øQui√©n se enamor√≥ primero? üëÄ", a: ["T√∫", "Yo", "Al mismo tiempo", "Fue el destino"], correct: 2 },
            { q: "¬øCu√°l es mi comida favorita?", a: ["Pizza", "Chocman", "T√∫ üíò", "Hamburguesa", "Fideos con salsa"], correct: 4 }
        ];

        let currentQ = 0;
        let userAnswers = [];
        let currentLockQ = 0;

        function nextLevel(hideId, showId) {
    // Definimos la variable 'musica' obteniendo el elemento por su ID
    const musica = document.getElementById('musica-fondo'); 
    
    // Ahora que existe, verificamos si est√° pausada para iniciarla
    if (musica && musica.paused) {
        musica.play().catch(e => console.log("El audio requiere interacci√≥n"));
        musica.volume = 0.4; 
    }

    document.getElementById(hideId).classList.add('hidden');
    document.getElementById(showId).classList.remove('hidden');

    if (showId === 'quiz-screen') document.getElementById('quiz-question').innerText = questions[currentQ];
    if (showId === 'adventure-screen') showAdventure('inicio');
    if (showId === 'game-screen') initSimbologia();
    if (showId === 'lock-screen') showLock();
    if (showId === 'puzzle-screen') initPuzzle();
}

        function handleQuizNext() {
            const val = document.getElementById('user-input').value.trim();
            if(!val) return alert("Escribe algo, amor... ‚ù§Ô∏è");
            userAnswers.push({ q: questions[currentQ], a: val });
            currentQ++;
            if(currentQ < questions.length) {
                document.getElementById('progress').innerText = `${currentQ + 1}/${questions.length}`;
                document.getElementById('quiz-question').innerText = questions[currentQ];
                document.getElementById('user-input').value = "";
            } else {
                enviarRespuestas();
                nextLevel('quiz-screen', 'adventure-screen');
            }
        }

        function showAdventure(step) {
            const data = adventureData[step];
            document.getElementById('adventure-question').innerText = data.q;
            const container = document.getElementById('adventure-options');
            container.innerHTML = '';
            
            data.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "btn-adventure bg-white p-4 rounded-2xl font-semibold shadow-sm text-rose-500 border-2 border-rose-100 hover:bg-rose-50";
                btn.innerText = opt.t;
                btn.onclick = () => {
                    if(opt.next === "FIN") nextLevel('adventure-screen', 'game-screen');
                    else showAdventure(opt.next);
                };
                container.appendChild(btn);
            });
        }

        function showLock() {
            const data = lockQuestions[currentLockQ];
            document.getElementById('lock-question').innerText = data.q;
            document.getElementById('lock-progress').innerText = `Paso ${currentLockQ + 1} de ${lockQuestions.length}`;
            
            const container = document.getElementById('lock-options');
            container.innerHTML = '';
            
            data.a.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = "bg-rose-50 p-4 rounded-xl border-2 border-rose-100 font-bold text-rose-600 active:bg-rose-200 transition duration-200";
                btn.innerText = opt;
                btn.onclick = () => checkLock(i);
                container.appendChild(btn);
            });
        }

        function checkLock(index) {
            if(index === lockQuestions[currentLockQ].correct) {
                currentLockQ++;
                if(currentLockQ < lockQuestions.length) {
                    showLock();
                } else {
                    document.getElementById('lock-visual').classList.add('unlocked');
                    document.getElementById('lock-icon').innerText = "üíñ";
                    
                    setTimeout(() => {
                        // Liberamos el scroll y pasamos a la carta
                        const body = document.getElementById('main-body');
                        body.classList.remove('overflow-hidden');
                        body.classList.add('allow-scroll');
                        nextLevel('lock-screen', 'puzzle-screen');
                        typeWriter(); 
                    }, 1200);
                }
            } else {
                alert("¬°Clave incorrecta! Intenta recordar bien nuestro inicio... ‚ù§Ô∏è");
            }
        }

        async function enviarRespuestas() {
            try {
                await fetch(`https://formspree.io/f/${FORMSPREE_ID}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ respuestas: userAnswers })
                });
            } catch (e) { console.log("Sent"); }
        }

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const storyOverlay = document.getElementById('story-overlay');
        const storyText = document.getElementById('story-text');

        let gameActive = true;
        let speed = 2;
        let distance = 0;
        let player = { x: 50, y: 200, r: 20, vy: 0, gravity: 0.15, lift: -4 };
        let pressing = false;

        const milestones = [
            { d: 500, icon: 'üé§', text: "El d√≠a del concierto de Kidd Voodoo... solo t√∫ y yo sabemos." },
            { d: 1500, icon: 'üêï', text: "Rescatamos 7 vidas... y ellos rescataron las nuestras." },
            { d: 2500, icon: 'üßÅ', text: "Mi quequito y flores... porque te mereces todo cuando nadie m√°s est√°." },
            { d: 3500, icon: 'üéÇ', text: "Tu sorpresa de cumplea√±os... cuando me demostraste tu amor infinito." },
            { d: 4500, icon: '‚ú®', text: "Hoy: sue√±os, metas por cumplir y un amor que nada rompe." }
        ];

        function initSimbologia() {
            window.addEventListener('touchstart', (e) => { 
                if(gameActive) { e.preventDefault(); pressing = true; }
            }, {passive: false});
            window.addEventListener('touchend', () => pressing = false);
            requestAnimationFrame(gameLoop);
        }

        function gameLoop() {
            if(!gameActive) return;
            if (distance < 2000) canvas.style.background = `linear-gradient(to right, #2d3748, #fb7185)`;
            else canvas.style.background = `linear-gradient(to right, #fb7185, #fff1f2)`;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            if(pressing) player.vy += player.lift;
            player.vy += player.gravity;
            player.y += player.vy;
            player.vy *= 0.7;
            if(player.y > canvas.height - 30) player.y = canvas.height - 30;
            if(player.y < 30) player.y = 30;
            ctx.font = "40px serif";
            ctx.fillText("‚ù§Ô∏è", player.x - 20, player.y + 15);
            milestones.forEach(m => {
                let xPos = m.d - distance;
                if(xPos > 0 && xPos < canvas.width) {
                    ctx.font = "50px serif";
                    ctx.fillText(m.icon, xPos, 200);
                    if(Math.abs(xPos - player.x) < 40) showStory(m.text);
                }
            });
            distance += speed;
            if(distance > 5000) finishGame();
            else requestAnimationFrame(gameLoop);
        }

        function showStory(txt) {
            storyText.innerText = txt;
            storyOverlay.style.opacity = 1;
            setTimeout(() => storyOverlay.style.opacity = 0, 3000);
        }

        function finishGame() {
            gameActive = false;
            // FIX: Ahora pasa a la misi√≥n 4 (lock-screen) en lugar del final
            nextLevel('game-screen', 'lock-screen');
        }

        const loveText = `Nuestra relaci√≥n no empez√≥ en un jard√≠n de rosas. Fue duro, dif√≠cil de manejar y hubo momentos donde el cielo parec√≠a estar siempre gris. Pero nos mantuvimos fuertes. Nos elegimos cuando era m√°s f√°cil rendirse.

Hoy miro atr√°s y veo todo lo que hemos construido de algunos momentos que siempre viven en mi cabeza. La primera vez que nos abrimos sentimentalmente en las orillas del mar, En el concierto de Kidd Voodoo, los 7 cachorritos que cuidamos con tanto amor, cuando hicimos un grafiti demostrando nuestro amor ajksdk, cuando te tatuaste mi inicial, las sorpresas en nuestros cumplea√±os... esos momentos donde, cuando nadie m√°s estaba, nosotros nos ten√≠amos el uno al otro. 

Quiero que sepas algo hoy, en cualquier lugar del mundo: a pesar de cada discusi√≥n o pelea que tengamos, yo por ti voy a luchar siempre. S√© y tengo claro que yo tambien me he comportado super estupido contigo ultimamente, sabiendo que tu cambiaste soy yo el que no cambia y de vd que te juro, ahora te juro, que cambiare por ti y por mi. Porque me di cuenta que de vd no importa qu√© tan dif√≠cil se ponga el destino de nuestra vida, yo voy a seguir adelante porque mi √∫nico objetivo es estar contigo. Eres mi paz, mi tranquilidad y mi hogar,

Y no hay nada que me haga m√°s feliz que saber que t√∫ tambi√©n sientes lo mismo por m√≠. Te amo con todo mi coraz√≥n, y siempre lo har√©. Mi julieta (El Amor De Mi Vida) ‚ù§Ô∏è`;

        let charIndex = 0;
        function typeWriter() {
            if (charIndex < loveText.length) {
                document.getElementById("love-letter").innerHTML += loveText.charAt(charIndex);
                charIndex++;
                setTimeout(typeWriter, 45);
            }
        }
        // --- CONFIGURACI√ìN DEL PUZZLE ---
let puzzlePieces = [];
const correctOrder = [0, 1, 2, 3, 4, 5, 6, 7, 8];
let currentOrder = [...correctOrder];
let selectedPiece = null;

function initPuzzle() {
    const board = document.getElementById('puzzle-board');
    board.innerHTML = '';
    
    // Desordenar (shuffle)
    currentOrder.sort(() => Math.random() - 0.5);
    
    currentOrder.forEach((pos, index) => {
        const piece = document.createElement('div');
        piece.className = 'puzzle-piece';
        piece.dataset.index = index;
        piece.dataset.pos = pos;
        
        // Calcular coordenadas del fondo para nosotros.JPG
        const x = (pos % 3) * 100;
        const y = Math.floor(pos / 3) * 100;
        piece.style.backgroundImage = "url('nosotros2.JPG')"; 
        piece.style.backgroundPosition = `-${x}px -${y}px`;
        
        piece.onclick = () => handlePieceClick(piece);
        board.appendChild(piece);
    });
}

function handlePieceClick(piece) {
    if (!selectedPiece) {
        selectedPiece = piece;
        piece.classList.add('selected');
    } else {
        // Intercambiar posiciones en el DOM
        const piece1Index = selectedPiece.dataset.index;
        const piece2Index = piece.dataset.index;
        
        // Intercambiar en el array de seguimiento
        const temp = currentOrder[piece1Index];
        currentOrder[piece1Index] = currentOrder[piece2Index];
        currentOrder[piece2Index] = temp;
        
        // Limpiar selecci√≥n y refrescar tablero
        selectedPiece.classList.remove('selected');
        selectedPiece = null;
        renderBoard();
        checkPuzzleWin();
    }
}

function renderBoard() {
    const pieces = document.querySelectorAll('.puzzle-piece');
    pieces.forEach((piece, index) => {
        const pos = currentOrder[index];
        const x = (pos % 3) * 100;
        const y = Math.floor(pos / 3) * 100;
        piece.style.backgroundPosition = `-${x}px -${y}px`;
        piece.dataset.pos = pos;
    });
}

function checkPuzzleWin() {
    if (JSON.stringify(currentOrder) === JSON.stringify(correctOrder)) {
        document.getElementById('puzzle-message').style.opacity = '1';
        setTimeout(() => {
            const body = document.getElementById('main-body');
            body.classList.remove('overflow-hidden');
            body.classList.add('allow-scroll');
            nextLevel('puzzle-screen', 'final-screen');
            iniciarCierreEpico();
        }, 2000);
    }
}
function revelarSecreto() {
    const btn = document.getElementById('secret-btn');
    const msg = document.getElementById('secret-message');
    
    // Desaparece el bot√≥n y aparece el texto
    btn.classList.add('hidden');
    msg.classList.remove('hidden');
    
    // Toque extra: un peque√±o confeti en consola o efecto visual
    console.log("Easter egg activado por la coqueta oficial.");
}
function iniciarCierreEpico() {
    const steps = document.querySelectorAll('.step');
    let delay = 0;

    steps.forEach((step, index) => {
        setTimeout(() => {
            step.classList.remove('hidden');
            // Al llegar al √∫ltimo paso (la carta)
            if(index === steps.length - 1) {
                // Liberamos el scroll del body para que pueda leer la carta larga en el iPad
                const body = document.getElementById('main-body');
                body.classList.remove('overflow-hidden');
                body.classList.add('allow-scroll');
                // Iniciamos el efecto de escritura de tu carta
                typeWriter();
            }
            // Auto-scroll hacia la nueva imagen que aparece
            step.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, delay);
        
        delay += 3500; // Tiempo entre cada foto (3.5 segundos)
    });
}
    </script>
</body>
</html>
